<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>fetch</title>
</head>
<style>
    .famille {
        display: none;
    }

    .famille2 {
        display: block;
    }
</style>

<body>
    <h1>Famille Games of thrones</h1>
    <section></section>

    <script>

        class Got {
            constructor(target) {
                this.target = target
                this.section = document.querySelector('section')
                this.get()
            }
            get() {
                fetch(this.target).then((response) => {
                    if (response.ok) {
                        console.log('Requete abouti');
                    }
                    response.json().then((data) => {
                        this.addData(data)
                    })
                }).catch((err) => {
                    console.log('Erreur du retour serveur ' + err);
                })
            }
            addData(data) {
                // console.log(data)
                for (let i = 0; i < data.length; i++) {
                    let el = document.createElement('div')
                    // console.log(data[i].gens)
                    el.className = 'famille2'
                    el.className = 'famille'
                    // console.log(this.section);
                    let nameFamille = document.createElement('h2')
                    nameFamille.textContent = data[i].nom
                    nameFamille.style.backgroundColor = 'red'
                    // div.appendChild(nameFamille)
                    this.section.appendChild(nameFamille)

                    nameFamille.addEventListener('click', () => {
                        el.setAttribute('datatogg', '0')
                        if (el.getAttribute('datatogg') == 0 ) {
                        el.style.display='block'
                        el.removeAttribute()
                        } 

                            // console.log(el)
                            // el.classList.toggle = 'famille2'
                        
                    })
                    // nameFamille.addEventListener('click', () => {
                    //     el.setAttribute('datatogg', '1')
                    //     if (el.getAttribute('datatogg') == 1) {
                    //         el.removeAttribute()
                    //         el.style.display = 'none'
                    //     }
                    // })
                    for (let j = 0; j < data[i].gens.length; j++) {
                        let name = document.createElement('h3')
                        name.textContent = data[i].gens[j].nom
                        el.appendChild(name)
                        this.section.appendChild(el)
                        // name.style.backgroundColor = '#222'

                        let descrip = document.createElement('p')
                        descrip.textContent = data[i].gens[j].description
                        el.appendChild(descrip)
                        this.section.appendChild(el)

                        let image = document.createElement('img')
                        image.src = data[i].gens[j].image
                        image.style.width = '10vw'
                        el.appendChild(image)
                        this.section.appendChild(el)

                        // console.log(data[i].gens[j].nom)
                    }
                }
            }
        }

        let requete = new Got('data/got.json')

        // let section = document.querySelector('section')
        // let get = async (url) => {
        //     let response = await fetch(url)
        //     if (response.ok) {
        //         let data = await response.json()
        //         console.log(data)
        //         for (let i = 0; i < data.length; i++) {
        //             // console.log(data[i].gens)
        //             let nameFamille = document.createElement('h2')
        //             nameFamille.textContent = data[i].nom
        //             section.appendChild(nameFamille)

        //             for (let j = 0; j < data[i].gens.length; j++) {
        //                 let name = document.createElement('h3')
        //                 name.textContent = data[i].gens[j].nom
        //                 section.appendChild(name)
        //                 name.style.backgroundColor = '#222'
        //                 name.style.color = 'white'


        //                 let descrip = document.createElement('p')
        //                 descrip.textContent = data[i].gens[j].description
        //                 section.appendChild(descrip)

        //                 let image = document.createElement('img')
        //                 image.src = data[i].gens[j].image
        //                 image.style.width = '10vw'
        //                 section.appendChild(image)

        //                 // console.log(data[i].gens[j].nom)
        //             }
        //         }
        //     } else {
        //         console.error('Erreur du retour serveur' + response.status)
        //     }
        // }
        // get('data/got.json')



    </script>
</body>

</html>